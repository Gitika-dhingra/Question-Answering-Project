{% extends "base.html" %}
{% block title %}Chatbot{% endblock title %}

{% block main %}
<h1>Chatbot</h1>

<!-- Upload Form -->
<form action="" enctype="multipart/form-data" method="post" style="margin-bottom: 20px;">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Upload File</button>
</form>

{% if file_text %}
    <h2>Extracted Text:</h2>
    <pre style="background-color: #f8f8f8; padding: 10px; border: 1px solid #ccc; white-space: pre-wrap;">
{{ file_text }}
    </pre>

    <hr>

    <!-- Chat Form -->
    <form method="post" style="margin-top: 20px;">
        {% csrf_token %}
        <label for="message"><strong>Ask something:</strong></label>
        <input type="text" name="message" id="message" style="width: 300px;">
        <button type="submit">Send</button>
    </form>
{% endif %}

<!-- Show AI Response -->
{% if ai_response %}
    <div style="margin-top: 20px;">
        <h3>Bot:</h3>
        <p>{{ ai_response }}</p>
    </div>
{% endif %}

<!-- Show Chat History -->
{% if chat_history %}
    <hr>
    <h2>Conversation History</h2>
    <div style="background: #f4f4f4; padding: 10px; border-radius: 5px;">
        {% for chat in chat_history %}
            <p><strong>You:</strong> {{ chat.user_message }}</p>
            <p><strong>Bot:</strong> {{ chat.ai_response }}</p>
            <hr>
        {% endfor %}
    </div>
{% endif %}
{% endblock main %}
